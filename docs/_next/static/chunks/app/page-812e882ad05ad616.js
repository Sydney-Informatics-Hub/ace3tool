(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{21440:function(){},80162:function(e,l,r){Promise.resolve().then(r.bind(r,8407))},8407:function(e,l,r){"use strict";r.d(l,{default:function(){return Z}});var t=r(20795),a=r(31528),s=r(99676),i=r(68951);let n={attention:{max:18,label:"Attention"},memory:{max:26,label:"Memory"},fluency:{max:14,label:"Fluency"},language:{max:26,label:"Language"},visuospatial:{max:16,label:"Visuospatial"}},o=e=>"The score for ".concat(e.label," should be less than ").concat(e.max),c=(0,i.Ry)({attention:(0,i.Rx)().label(n.attention.label).integer().min(0).max(n.attention.max,o).typeError("Please enter a number").required(),memory:(0,i.Rx)().label(n.memory.label).integer().min(0).max(n.memory.max,o).typeError("Please enter a number").required(),fluency:(0,i.Rx)().label(n.fluency.label).integer().min(0).max(n.fluency.max,o).typeError("Please enter a number").required(),language:(0,i.Rx)().label(n.language.label).integer().min(0).max(n.language.max,o).typeError("Please enter a number").required(),visuospatial:(0,i.Rx)().label(n.visuospatial.label).integer().min(0).max(n.visuospatial.max,o).typeError("Please enter a number").required()}),d=["attention","memory","fluency","language","visuospatial"];var m=r(34215),u=r(97819);function h(e){let[l,r]=(0,u.useState)(!1),[t,a]=(0,u.useState)(0);return(0,u.useEffect)(()=>{c.validate(e).then(e=>{let l=Object.values(e).reduce((e,l)=>e+l,0);r(!0),a(l)}).catch(e=>{r(!1)})},[e]),{valid:l,total:t}}function x(e){let[l,r]=(0,u.useState)(!1),[t,a]=(0,u.useState)(void 0);return(0,u.useEffect)(()=>{c.validate(e).then(e=>{r(!0),a(e)}).catch(e=>{r(!1)})},[e]),{valid:l,scores:t}}function f(e){let{scores:l,model:r}=e,{valid:a,total:s}=h(l),{scores:i}=x(l),n=i?1-r.predict(i):void 0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(m.Ct,{className:"max-w-sm justify-center",size:"lg",children:["Total score: ",a?s:"..."]}),(0,t.jsxs)(m.Ct,{className:"max-w-sm justify-center",size:"lg",children:["Predicted risk: ",n?n.toPrecision(3):"..."]})]})}var p=r(90076);function g(e){let{width:l,height:r}=e;return(0,t.jsxs)("div",{role:"status",className:"w-".concat(l,"px h-").concat(r,"px p-4 animate-pulse md:p-6"),children:[(0,t.jsx)("div",{className:"h-2.5 bg-gray-200 rounded-full  w-1/2 mb-2.5"}),(0,t.jsx)("div",{className:"w-3/4 h-2 mb-10 bg-gray-200 rounded-full "}),(0,t.jsxs)("div",{className:"h-full flex items-baseline mt-4",children:[(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-3/4 "}),(0,t.jsx)("div",{className:"w-full h-1/2 ms-6 bg-gray-200 rounded-t-lg "}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-3/4 ms-6 "}),(0,t.jsx)("div",{className:"w-full h-4/5 ms-6 bg-gray-200 rounded-t-lg "}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-5/6 ms-6 "}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-3/4 ms-6 "}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-5/6 ms-6 "})]}),(0,t.jsx)("span",{className:"sr-only",children:"Loading..."})]})}let b=[{label:"Low risk",min:0,max:60,width:60},{label:"Moderate risk",min:60,max:80,width:20},{label:"High risk",min:80,max:100,width:20}];function v(e){let l=(0,u.useRef)(null),{scores:r}=e,{valid:a,total:s}=h(r);return(0,u.useEffect)(()=>{var e;let r=p.g({title:"Total score",width:500,height:150,x:{grid:!0,label:"ACE-III total score"},color:{type:"ordinal",scheme:"YlOrRd",domain:["Low risk","Moderate risk","High risk"],reverse:!0,legend:!0},marks:[p.Me({ticks:[]}),p.JA(b,{x1:"min",x2:"max",y1:0,y2:10,fill:"label",opacity:.7}),a?p.zD([{score:s}],{x:"score",stroke:"black",marker:"circle",strokeWidth:2}):null]});return null==l||null===(e=l.current)||void 0===e||e.replaceChildren(r),()=>r.remove()}),(0,t.jsx)("div",{ref:l,children:(0,t.jsx)(g,{width:500,height:150})})}function y(e){let{label:l,name:r,...s}=e,{register:i,getFieldState:n}=(0,a.Gc)(),o=n(r),c=o.isDirty?o.invalid?"failure":"success":void 0;return(0,t.jsxs)("div",{children:[(0,t.jsx)(m.__,{htmlFor:r,children:l}),(0,t.jsx)(m.oi,{type:"number",color:c,...i(r),...s}),o.error&&(0,t.jsx)("span",{className:"text-sm text-red-400",children:o.error.message})]})}function j(e){let{form:l}=e,{handleSubmit:r}=l;return(0,t.jsxs)(m.Zb,{className:"max-w-xl",id:"score-entry",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-indigo-700",children:"Enter ACE-III scale scores"}),(0,t.jsx)(a.RV,{...l,children:(0,t.jsxs)("form",{className:"flex flex-col max-w-lg gap-4 my-2",onSubmit:r(e=>console.log(e)),children:[(0,t.jsx)(y,{label:"Attention",name:"attention"}),(0,t.jsx)(y,{label:"Memory",name:"memory"}),(0,t.jsx)(y,{label:"Fluency",name:"fluency"}),(0,t.jsx)(y,{label:"Language",name:"language"}),(0,t.jsx)(y,{label:"Visuospatial",name:"visuospatial"})]})})]})}let w=function(e){let l=0,r=[];return[...Array(100).keys()].map(()=>{r.push({start:l,end:l+.01}),l+=.01}),r}(0);function k(e){let l=(0,u.useRef)(null),{model:r}=e,{scores:a}=x(e.scores),s=a?1-r.predict(a):void 0,i=a?r.confidence_interval(a):void 0,n=void 0!==i?{upper:1-i[0],lower:1-i[1]}:void 0;return(0,u.useEffect)(()=>{var e;let r=p.g({title:"Predicted risk of dementia",width:500,height:150,x:{grid:!0,label:"Risk"},color:{type:"sequential",scheme:"magma",domain:[0,1]},marks:[p.Me({ticks:[]}),p.JA(w,{x1:"start",x2:"end",y1:0,y2:10,fill:"start",opacity:.7}),n?p.VD([n],{x1:"lower",x2:"upper",y:5,stroke:"#404040",strokeWidth:1}):null,s?p.zD([{score:s}],{x:"score",stroke:"black",marker:"circle",strokeWidth:2}):null]});return null==l||null===(e=l.current)||void 0===e||e.replaceChildren(r),()=>r.remove()},[s,n]),(0,t.jsx)("div",{ref:l,children:(0,t.jsx)(g,{width:500,height:150})})}var N=JSON.parse('{"FO":{"intercept":-10.32498577197637,"coefs":{"attention":0.32488943647638785,"memory":0.38489972502392367,"fluency":0.6649399088480656,"language":0.8122292594499009,"visuospatial":0.27262320144200186}},"gy":[[1.1198148056383341,-0.04667157889023354,-0.029050628130672468,-0.03154225255108559,-0.1190583591997873,-0.029332239835712218],[-0.04667157889023354,0.01990916962066307,-0.0018505615413595914,-0.0003122597422042938,0.0013568544291487523,-0.004227463027503619],[-0.029050628130672468,-0.0018505615413595914,0.0051743515623118045,0.00037707762389274115,-0.0002226042259692137,-0.00009327160777052855],[-0.03154225255108559,-0.0003122597422042938,0.00037707762389274115,0.010118577556215019,-0.0008425351174451155,-0.0019587136699196254],[-0.1190583591997873,0.0013568544291487523,-0.0002226042259692137,-0.0008425351174451155,0.025285453489057252,-0.00045303533243386105],[-0.029332239835712218,-0.004227463027503619,-0.00009327160777052855,-0.0019587136699196254,-0.00045303533243386105,0.02528815793412658]],"qh":{"attention":13.74361088,"memory":16.7830033,"fluency":6.91990091,"language":20.02885408,"visuospatial":13.13685078}}'),_=r(1560),E=r(73317),I=r(41180),R=r(41940),q=r(85772),C=r(13338),O=r(26868),A=r.n(O);let P=(0,_.U)({matrixDependencies:E.Q,multiplyDependencies:I._,sqrtDependencies:R.E,transposeDependencies:q.p});class S{has_vcov(){return void 0!==this.vcov}has_means(){return void 0!==this.predictor_means}get_centered_data(e){if(!this.has_means())throw Error("You must provide predictor_means in the options to center data");return Object.fromEntries(this.predictors.map(l=>{let r=e[l]-this.predictor_means[l];return[l,r]}))}linear_prediction(e){let l=this.center_predictors?this.get_centered_data(e):e;return this.coefs.intercept+this.predictors.reduce((e,r)=>e+this.coefs.coefs[r]*l[r],0)}predict(e){return D(this.linear_prediction(e))}confidence_interval(e){var l;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95;if(!this.has_vcov())throw Error("You must provide vcov (the variance-covariance matrix) to calculate confidence intervals");let t=this.center_predictors?this.get_centered_data(e):e,a=(l=1-(1-r)/2,Math.sqrt(2)*A()(2*l-1)),s=(0,C.pIu)([1,...Object.values(t)]),i=P.multiply(P.multiply(s,this.vcov),P.transpose(s)),n=P.sqrt(i),o=this.linear_prediction(e);return[D(o-n*a),D(o+n*a)]}constructor(e,l){this.predictors=Object.keys(e.coefs),this.coefs=e,this.vcov=(null==l?void 0:l.vcov)?P.matrix(l.vcov):void 0,this.center_predictors=(null==l?void 0:l.center_predictors)||!1,this.predictor_means=(null==l?void 0:l.predictor_means)||void 0}}function D(e){return 1/(1+Math.exp(-1*e))}let M=new S(N.FO,{vcov:N.gy,predictor_means:N.qh,center_predictors:!0});function V(e){let l=(0,u.useRef)(null),r=e.scores,a=d.map(e=>({scale:n[e].label,score:r[e]?r[e]:0}));return(0,u.useEffect)(()=>{var e;let r=p.g({width:500,height:500,y:{label:"Score",domain:[0,30]},x:{domain:d.map(e=>n[e].label)},color:{type:"categorical",scheme:"Tableau10"},marks:[p.lU({label:null}),p.we(a,{y:"score",fill:"scale",x:"scale",stroke:"black",opacity:.8})]});return null==l||null===(e=l.current)||void 0===e||e.replaceChildren(r),()=>r.remove()},[a]),(0,t.jsx)("div",{ref:l,children:(0,t.jsx)(g,{width:500,height:500})})}var z=JSON.parse('{"B":{"attention":17,"fluency":9,"language":24,"memory":22,"visuospatial":16}}');let F=d.map(e=>[...Array(50).keys()].map(()=>{let l=(0,C.Iyf)(40,100),r=Math.random()+l/100<1;return{scale:n[e].label,score:l,dementia:r,dementia_fill:r?"white":"black"}})).flat();function L(e){let l=(0,u.useRef)(null),{model:r}=e,{scores:a}=x(e.scores),s=a?1-r.predict(a):void 0,i=d.map(e=>({scale:n[e].label,height:100})),o=d.map(e=>{let l=z.B[e]/n[e].max*100;return{scale:n[e].label,threshold:l}}),c=d.map(e=>{let l=a?a[e]/n[e].max*100:void 0;return{scale:n[e].label,value:l}});return(0,u.useEffect)(()=>{var e;let r=p.g({width:500,height:500,y:{label:"Score (% of maximum)",domain:[0,100]},facet:{data:i,x:"scale",label:null},fx:{domain:d.map(e=>n[e].label)},color:{type:"categorical",scheme:"Tableau10"},marks:[p.Me({ticks:[],labelAnchor:"center",labelArrow:"none"}),p.we(i,{y:"height",fill:"scale",fx:"scale",opacity:.5,stroke:"black",strokeOpacity:1}),p.AK(F,p.X$("middle",{fx:"scale",y:"score",fill:"dementia_fill"})),p.rP(o,{fx:"scale",y:"threshold",stroke:"red",strokeDasharray:"3,3,3",strokeWidth:2}),a?p.rP(c,{fx:"scale",y:"value",strokeWidth:2,marker:"circle",stroke:"#5850ec"}):null]});return null==l||null===(e=l.current)||void 0===e||e.replaceChildren(r),()=>r.remove()},[s,i,c,o,a]),(0,t.jsx)("div",{ref:l,children:(0,t.jsx)(g,{width:500,height:500})})}function T(e){return(0,t.jsxs)("div",{...e,children:[(0,t.jsx)("h2",{className:"text-indigo-600 font-bold text-lg",children:"Subdomain scores"}),(0,t.jsx)("p",{className:"text-gray-800",children:"This plot compares the current scores for each subdomain to those from a sample of patients with dementia and healthy controls"}),(0,t.jsx)("h3",{className:"text-lg text-indigo-800 font-bold mt-2",children:"Legend"}),(0,t.jsxs)(m.aV,{unstyled:!0,className:"my-1 space-y-3",children:[(0,t.jsxs)(m.aV.Item,{children:[(0,t.jsxs)("span",{className:"inline-flex items-center text-indigo-600 text-base p-1 border-2 me-2",children:["●",(0,t.jsx)("hr",{className:"w-4 h-1 bg-indigo-600"}),"●"]}),"Current score"]}),(0,t.jsxs)(m.aV.Item,{children:[(0,t.jsx)("span",{className:"text-red-600 font-bold p-1 border-2 me-2",children:"- - -"}),"80% of dementia patients in the sample scored at or below this level"]}),(0,t.jsxs)(m.aV.Item,{children:[(0,t.jsx)("span",{className:"text-xl text-gray-600 p-1 border-2 me-2",children:"○"})," ","Sample patient with dementia"]}),(0,t.jsxs)(m.aV.Item,{children:[(0,t.jsx)("span",{className:"text-xl text-black p-1 border-2 me-2",children:"●"})," ","Control patient (no dementia)"]})]})]})}function W(e){let{scores:l,model:r,...a}=e;return(0,t.jsx)(m.Zb,{...a,children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,t.jsx)("div",{className:"lg:basis-1/2",children:(0,t.jsx)(L,{scores:l,model:r})}),(0,t.jsx)(T,{id:"swarm-legend",className:"lg:basis-1/2 text-base max-w-prose"})]})})}let J={root:{base:"flex rounded-lg border border-gray-200 bg-white shadow-md dark:border-gray-700 dark:bg-gray-800",children:"flex h-full flex-col justify-center gap-4 p-2 md:p-6",horizontal:{off:"flex-col",on:"flex-col md:max-w-xl md:flex-row"},href:"hover:bg-gray-100 dark:hover:bg-gray-700"},img:{base:"",horizontal:{off:"rounded-t-lg",on:"h-96 w-full rounded-t-lg object-cover md:h-auto md:w-48 md:rounded-none md:rounded-l-lg"}}};function Z(){let e=(0,a.cI)({mode:"all",defaultValues:c.getDefault(),resolver:(0,s.X)(c)}),{control:l,formState:r}=e,{errors:i}=r,n=(0,a.qo)({control:l});return(0,t.jsxs)("div",{id:"ace-form",className:"flex flex-col lg:flex-row lg:flex-wrap gap-2 md:gap-4 ",children:[(0,t.jsx)(j,{form:e}),(0,t.jsxs)(m.Zb,{id:"data-display-simple",className:"flex-col max-w-xl space-y-4 min-w-96",theme:J,children:[(0,t.jsx)(f,{scores:n,model:M}),(0,t.jsx)(V,{scores:n})]}),(0,t.jsxs)(m.Zb,{id:"risk-plots",className:"flex-col max-w-xl space-y-4",children:[(0,t.jsx)(v,{scores:n}),(0,t.jsx)(k,{scores:n,model:M})]}),(0,t.jsx)(W,{id:"swarm-plots",className:"max-w-full",scores:n,model:M})]})}}},function(e){e.O(0,[431,188,156,459,949,464,215,569,274,346,744],function(){return e(e.s=80162)}),_N_E=e.O()}]);