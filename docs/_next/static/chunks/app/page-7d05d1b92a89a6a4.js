(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{21440:function(){},80162:function(e,t,l){Promise.resolve().then(l.bind(l,362))},362:function(e,t,l){"use strict";l.d(t,{default:function(){return X}});var r=l(20795),a=l(62334),s=l(38123),i=l(68951);let n={attention:{max:18,label:"Attention"},memory:{max:26,label:"Memory"},fluency:{max:14,label:"Fluency"},language:{max:26,label:"Language"},visuospatial:{max:16,label:"Visuospatial"}},o=e=>"The score for ".concat(e.label," should be less than ").concat(e.max),c=(0,i.Ry)({attention:(0,i.Rx)().label(n.attention.label).integer().min(0).max(n.attention.max,o).typeError("Please enter a number").required(),memory:(0,i.Rx)().label(n.memory.label).integer().min(0).max(n.memory.max,o).typeError("Please enter a number").required(),fluency:(0,i.Rx)().label(n.fluency.label).integer().min(0).max(n.fluency.max,o).typeError("Please enter a number").required(),language:(0,i.Rx)().label(n.language.label).integer().min(0).max(n.language.max,o).typeError("Please enter a number").required(),visuospatial:(0,i.Rx)().label(n.visuospatial.label).integer().min(0).max(n.visuospatial.max,o).typeError("Please enter a number").required()}),d=["attention","memory","fluency","language","visuospatial"];var m=l(97819),u=l(83290);function h(e){let[t,l]=(0,m.useState)(!1),[r,a]=(0,m.useState)(0);return(0,m.useEffect)(()=>{c.validate(e).then(e=>{let t=Object.values(e).reduce((e,t)=>e+t,0);l(!0),a(t)}).catch(e=>{l(!1)})},[e]),{valid:t,total:r}}function x(e){let{width:t,height:l}=e;return(0,r.jsxs)("div",{role:"status",className:"w-".concat(t,"px h-").concat(l,"px p-4 animate-pulse md:p-6"),children:[(0,r.jsx)("div",{className:"h-2.5 bg-gray-200 rounded-full  w-1/2 mb-2.5"}),(0,r.jsx)("div",{className:"w-3/4 h-2 mb-10 bg-gray-200 rounded-full "}),(0,r.jsxs)("div",{className:"h-full flex items-baseline mt-4",children:[(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-3/4 "}),(0,r.jsx)("div",{className:"w-full h-1/2 ms-6 bg-gray-200 rounded-t-lg "}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-3/4 ms-6 "}),(0,r.jsx)("div",{className:"w-full h-4/5 ms-6 bg-gray-200 rounded-t-lg "}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-5/6 ms-6 "}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-3/4 ms-6 "}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-5/6 ms-6 "})]}),(0,r.jsx)("span",{className:"sr-only",children:"Loading..."})]})}let f=[{label:"High risk",min:0,max:60,width:60},{label:"Moderate risk",min:60,max:80,width:20},{label:"Low risk",min:80,max:100,width:20}];function p(e){let t=(0,m.useRef)(null),{scores:l}=e,{valid:a,total:s}=h(l);return(0,m.useEffect)(()=>{var e;let l=u.g({title:a?"Total score: ".concat(s):"Total score",width:500,height:150,x:{grid:!0,label:"ACE-III total score"},color:{type:"ordinal",scheme:"YlOrRd",domain:["Low risk","Moderate risk","High risk"],legend:!0},marks:[u.Me({ticks:[]}),u.JA(f,{x1:"min",x2:"max",y1:0,y2:10,fill:"label",opacity:.7}),a?u.zD([{score:s}],{x:"score",stroke:"black",marker:"circle",strokeWidth:2}):null]});return null==t||null===(e=t.current)||void 0===e||e.replaceChildren(l),()=>l.remove()},[a,s]),(0,r.jsx)("div",{ref:t,children:(0,r.jsx)(x,{width:500,height:150})})}var g=l(98451);function b(e){let{label:t,name:l,...s}=e,{register:i,getFieldState:n}=(0,a.Gc)(),o=n(l),c=o.isDirty?o.invalid?"failure":"success":void 0;return(0,r.jsxs)("div",{children:[(0,r.jsx)(g.__,{htmlFor:l,children:t}),(0,r.jsx)(g.oi,{type:"number",color:c,...i(l),...s}),o.error&&(0,r.jsx)("span",{className:"text-sm text-red-400",children:o.error.message})]})}function v(e){let{form:t}=e,{handleSubmit:l}=t;return(0,r.jsxs)(g.Zb,{className:"max-w-xl",id:"score-entry",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-indigo-700",children:"Enter ACE-III scale scores"}),(0,r.jsx)(a.RV,{...t,children:(0,r.jsxs)("form",{className:"flex flex-col max-w-lg gap-4 my-2",onSubmit:l(e=>console.log(e)),children:[(0,r.jsx)(b,{label:"Attention",name:"attention"}),(0,r.jsx)(b,{label:"Memory",name:"memory"}),(0,r.jsx)(b,{label:"Fluency",name:"fluency"}),(0,r.jsx)(b,{label:"Language",name:"language"}),(0,r.jsx)(b,{label:"Visuospatial",name:"visuospatial"})]})})]})}function y(e){let[t,l]=(0,m.useState)(!1),[r,a]=(0,m.useState)(void 0);return(0,m.useEffect)(()=>{c.validate(e).then(e=>{l(!0),a(e)}).catch(e=>{l(!1)})},[e]),{valid:t,scores:r}}let j=function(e){let t=0,l=[];return[...Array(100).keys()].map(()=>{l.push({start:t,end:t+1}),t+=1}),l}(0);function k(e){let t=(0,m.useRef)(null),{model:l}=e,{scores:a}=y(e.scores),s=a?(1-l.predict(a))*100:void 0;return(0,m.useEffect)(()=>{var e;let r=a?l.confidence_interval(a):void 0,i=void 0!==r?{upper:1-r[0],lower:1-r[1]}:void 0,n=u.g({title:s?"Predicted risk of dementia (subdomain model): ".concat(Math.round(s),"%"):"Predicted risk of dementia (subdomain model)",width:500,height:150,x:{grid:!0,label:"Risk (%)",reverse:!0},color:{type:"sequential",scheme:"magma",domain:[0,100],reverse:!0},marks:[u.Me({ticks:[]}),u.JA(j,{x1:"start",x2:"end",y1:0,y2:10,fill:"start",opacity:.7}),i?u.VD([i],{x1:"lower",x2:"upper",y:5,stroke:"#404040",strokeWidth:1}):null,s?u.zD([{score:s}],{x:"score",stroke:"black",marker:"circle",strokeWidth:2}):null]});return null==t||null===(e=t.current)||void 0===e||e.replaceChildren(n),()=>n.remove()},[s,l,a]),(0,r.jsx)("div",{ref:t,children:(0,r.jsx)(x,{width:500,height:150})})}var w=JSON.parse('{"FO":{"intercept":-10.32498577197637,"coefs":{"attention":0.32488943647638785,"memory":0.38489972502392367,"fluency":0.6649399088480656,"language":0.8122292594499009,"visuospatial":0.27262320144200186}},"gy":[[1.1198148056383341,-0.04667157889023354,-0.029050628130672468,-0.03154225255108559,-0.1190583591997873,-0.029332239835712218],[-0.04667157889023354,0.01990916962066307,-0.0018505615413595914,-0.0003122597422042938,0.0013568544291487523,-0.004227463027503619],[-0.029050628130672468,-0.0018505615413595914,0.0051743515623118045,0.00037707762389274115,-0.0002226042259692137,-0.00009327160777052855],[-0.03154225255108559,-0.0003122597422042938,0.00037707762389274115,0.010118577556215019,-0.0008425351174451155,-0.0019587136699196254],[-0.1190583591997873,0.0013568544291487523,-0.0002226042259692137,-0.0008425351174451155,0.025285453489057252,-0.00045303533243386105],[-0.029332239835712218,-0.004227463027503619,-0.00009327160777052855,-0.0019587136699196254,-0.00045303533243386105,0.02528815793412658]],"qh":{"attention":13.74361088,"memory":16.7830033,"fluency":6.91990091,"language":20.02885408,"visuospatial":13.13685078}}'),N=JSON.parse('{"F":{"intercept":-47.4088699927874,"coefs":{"total":0.52193652586342}},"q":{"total":70.82303371}}'),_=l(1560),E=l(73317),q=l(41180),R=l(41940),A=l(85772),I=l(13338),M=l(26868),O=l.n(M);let S=(0,_.U)({matrixDependencies:E.Q,multiplyDependencies:q._,sqrtDependencies:R.E,transposeDependencies:A.p});class P{has_vcov(){return void 0!==this.vcov}has_means(){return void 0!==this.predictor_means}get_centered_data(e){if(!this.has_means())throw Error("You must provide predictor_means in the options to center data");return Object.fromEntries(this.predictors.map(t=>{let l=e[t]-this.predictor_means[t];return[t,l]}))}linear_prediction(e){let t=this.center_predictors?this.get_centered_data(e):e;return this.coefs.intercept+this.predictors.reduce((e,l)=>e+this.coefs.coefs[l]*t[l],0)}predict(e){return C(this.linear_prediction(e))}confidence_interval(e){var t;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95;if(!this.has_vcov())throw Error("You must provide vcov (the variance-covariance matrix) to calculate confidence intervals");let r=this.center_predictors?this.get_centered_data(e):e,a=(t=1-(1-l)/2,Math.sqrt(2)*O()(2*t-1)),s=(0,I.pIu)([1,...Object.values(r)]),i=S.multiply(S.multiply(s,this.vcov),S.transpose(s)),n=S.sqrt(i),o=this.linear_prediction(e);return[C(o-n*a),C(o+n*a)]}constructor(e,t){this.predictors=Object.keys(e.coefs),this.coefs=e,this.vcov=(null==t?void 0:t.vcov)?S.matrix(t.vcov):void 0,this.center_predictors=(null==t?void 0:t.center_predictors)||!1,this.predictor_means=(null==t?void 0:t.predictor_means)||void 0}}function C(e){return 1/(1+Math.exp(-1*e))}let D=new P(w.FO,{vcov:w.gy,predictor_means:w.qh,center_predictors:!0}),V=new P(N.F,{predictor_means:N.q,center_predictors:!1});function T(e){let t=(0,m.useRef)(null),l=e.scores,a=d.map(e=>({scale:n[e].label,score:l[e]?l[e]:0,max:n[e].max}));return(0,m.useEffect)(()=>{var e;let l=u.g({width:500,height:500,title:"Subdomain scores",y:{label:"Score",domain:[0,27]},x:{domain:d.map(e=>n[e].label),padding:.2},color:{type:"categorical",scheme:"Tableau10"},marks:[u.lU({label:null}),u.we(a,{y:"max",x:"scale",fill:"scale",opacity:.3,inset:-5,insetBottom:0}),u.we(a,{y:"score",fill:"scale",x:"scale",opacity:.8,stroke:"black"})]});return null==t||null===(e=t.current)||void 0===e||e.replaceChildren(l),()=>l.remove()},[a]),(0,r.jsx)("div",{ref:t,children:(0,r.jsx)(x,{width:500,height:500})})}var F=JSON.parse('{"B":{"attention":17,"fluency":9,"language":24,"memory":22,"visuospatial":16,"total":81}}');let J=[...d,"total"],L={...n,total:{max:100,label:"Total"}},W=J.map(e=>[...Array(50).keys()].map(()=>{let t=(0,I.Iyf)(40,100),l=Math.random()+t/100<1;return{scale:L[e].label,score:t,dementia:l,dementia_fill:l?"white":"black"}})).flat();function z(e){let t=(0,m.useRef)(null),{model:l}=e,{scores:a}=y(e.scores),{total:s}=h(e.scores),i=a?{...a,total:s}:void 0,o=a?1-l.predict(a):void 0,c=J.map(e=>({scale:L[e].label,height:100})),f=J.map(e=>{let t=F.B[e]/L[e].max*100;return{scale:L[e].label,threshold:t}}),p=J.map(e=>{let t=i?i[e]/L[e].max*100:void 0;return{scale:L[e].label,value:t}});return(0,m.useEffect)(()=>{var e;let l=u.g({width:500,height:500,y:{label:"Score (% of maximum)",domain:[0,100]},facet:{data:c,x:"scale",label:null},fx:{domain:[...d.map(e=>n[e].label),"Total"]},color:{type:"categorical",scheme:"Tableau10",domain:[...d.map(e=>n[e].label),"Total"]},marks:[u.Me({ticks:[],labelAnchor:"center",labelArrow:"none"}),u.we(c,{y:"height",fill:"scale",fx:"scale",opacity:.5,stroke:"black",strokeOpacity:1}),u.AK(W,u.X$("middle",{fx:"scale",y:"score",fill:"dementia_fill"})),u.rP(f,{fx:"scale",y:"threshold",stroke:"red",strokeDasharray:"3,3,3",strokeWidth:2}),a?u.rP(p,{fx:"scale",y:"value",strokeWidth:2,marker:"circle",stroke:"#5850ec"}):null]});return null==t||null===(e=t.current)||void 0===e||e.replaceChildren(l),()=>l.remove()},[o,c,p,f,a]),(0,r.jsx)("div",{ref:t,children:(0,r.jsx)(x,{width:500,height:500})})}function Z(e){return(0,r.jsxs)("div",{...e,children:[(0,r.jsx)("h2",{className:"text-indigo-600 font-bold text-lg",children:"Subdomain scores"}),(0,r.jsx)("p",{className:"text-gray-800",children:"This plot compares the current scores for each subdomain to those from a sample of patients with dementia and healthy controls"}),(0,r.jsx)("h3",{className:"text-lg text-indigo-800 font-bold mt-2",children:"Legend"}),(0,r.jsxs)(g.aV,{unstyled:!0,className:"my-1 space-y-3",children:[(0,r.jsxs)(g.aV.Item,{children:[(0,r.jsxs)("span",{className:"inline-flex items-center text-indigo-600 text-base p-1 border-2 me-2",children:["●",(0,r.jsx)("hr",{className:"w-4 h-1 bg-indigo-600"}),"●"]}),"Current score"]}),(0,r.jsxs)(g.aV.Item,{children:[(0,r.jsx)("span",{className:"text-red-600 font-bold p-1 border-2 me-2",children:"- - -"}),"80% of dementia patients in the sample scored at or below this level"]}),(0,r.jsxs)(g.aV.Item,{children:[(0,r.jsx)("span",{className:"text-xl text-gray-600 p-1 border-2 me-2",children:"○"})," ","Sample patient with dementia"]}),(0,r.jsxs)(g.aV.Item,{children:[(0,r.jsx)("span",{className:"text-xl text-black p-1 border-2 me-2",children:"●"})," ","Control patient (no dementia)"]})]})]})}function B(e){let{scores:t,model:l,...a}=e;return(0,r.jsx)(g.Zb,{...a,children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,r.jsx)("div",{className:"lg:basis-1/2",children:(0,r.jsx)(z,{scores:t,model:l})}),(0,r.jsx)(Z,{id:"swarm-legend",className:"lg:basis-1/2 text-base max-w-prose"})]})})}let Y=function(e){let t=0,l=[];return[...Array(100).keys()].map(()=>{l.push({start:t,end:t+1}),t+=1}),l}(0);function H(e){let t=(0,m.useRef)(null),{model:l}=e,{valid:a,total:s}=h(e.scores),i=a?(1-l.predict({total:s}))*100:void 0;return(0,m.useEffect)(()=>{var e;let l=u.g({title:i?"Predicted risk of dementia (total score model): ".concat(Math.round(i),"%"):"Predicted risk of dementia (total score model)",width:500,height:150,x:{grid:!0,label:"Risk (%)",reverse:!0},color:{type:"sequential",scheme:"magma",domain:[0,100],reverse:!0},marks:[u.Me({ticks:[]}),u.JA(Y,{x1:"start",x2:"end",y1:0,y2:10,fill:"start",opacity:.7}),i?u.zD([{score:i}],{x:"score",stroke:"black",marker:"circle",strokeWidth:2}):null]});return null==t||null===(e=t.current)||void 0===e||e.replaceChildren(l),()=>l.remove()},[i,l,a,s]),(0,r.jsx)("div",{ref:t,children:(0,r.jsx)(x,{width:500,height:150})})}let U={root:{base:"flex rounded-lg border border-gray-200 bg-white shadow-md dark:border-gray-700 dark:bg-gray-800",children:"flex h-full flex-col justify-center gap-4 p-2 md:p-6",horizontal:{off:"flex-col",on:"flex-col md:max-w-xl md:flex-row"},href:"hover:bg-gray-100 dark:hover:bg-gray-700"},img:{base:"",horizontal:{off:"rounded-t-lg",on:"h-96 w-full rounded-t-lg object-cover md:h-auto md:w-48 md:rounded-none md:rounded-l-lg"}}};function X(){let e=(0,a.cI)({mode:"all",defaultValues:c.getDefault(),resolver:(0,s.X)(c)}),{control:t,formState:l}=e,{errors:i}=l,n=(0,a.qo)({control:t});return(0,r.jsxs)("div",{id:"ace-form",className:"flex flex-col lg:flex-row lg:flex-wrap gap-2 md:gap-4 ",children:[(0,r.jsx)(v,{form:e}),(0,r.jsx)(g.Zb,{id:"risk-plots",className:"max-w-xl",children:(0,r.jsxs)("div",{className:"flex flex-col justify-start space-y-4",children:[(0,r.jsx)(p,{scores:n}),(0,r.jsx)(k,{scores:n,model:D}),(0,r.jsx)(H,{scores:n,model:V})]})}),(0,r.jsx)(g.Zb,{id:"data-display-simple",className:"flex-col max-w-xl space-y-4 min-w-96",theme:U,children:(0,r.jsx)(T,{scores:n})}),(0,r.jsx)(B,{id:"swarm-plots",className:"max-w-full",scores:n,model:D})]})}}},function(e){e.O(0,[431,188,156,459,949,236,451,914,274,346,744],function(){return e(e.s=80162)}),_N_E=e.O()}]);