(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{21440:function(){},80162:function(e,r,l){Promise.resolve().then(l.bind(l,61096))},61096:function(e,r,l){"use strict";l.d(r,{default:function(){return Z}});var a=l(20795),t=l(31528),s=l(99676),i=l(68951);let n={attention:{max:18,label:"Attention"},memory:{max:26,label:"Memory"},fluency:{max:14,label:"Fluency"},language:{max:26,label:"Language"},visuospatial:{max:16,label:"Visuospatial"}},o=e=>"The score for ".concat(e.label," should be less than ").concat(e.max),c=(0,i.Ry)({attention:(0,i.Rx)().label(n.attention.label).integer().min(0).max(n.attention.max,o).typeError("Please enter a number").required(),memory:(0,i.Rx)().label(n.memory.label).integer().min(0).max(n.memory.max,o).typeError("Please enter a number").required(),fluency:(0,i.Rx)().label(n.fluency.label).integer().min(0).max(n.fluency.max,o).typeError("Please enter a number").required(),language:(0,i.Rx)().label(n.language.label).integer().min(0).max(n.language.max,o).typeError("Please enter a number").required(),visuospatial:(0,i.Rx)().label(n.visuospatial.label).integer().min(0).max(n.visuospatial.max,o).typeError("Please enter a number").required()}),d=["attention","memory","fluency","language","visuospatial"];var m=l(34215),u=l(97819);function x(e){let[r,l]=(0,u.useState)(!1),[a,t]=(0,u.useState)(0);return(0,u.useEffect)(()=>{c.validate(e).then(e=>{let r=Object.values(e).reduce((e,r)=>e+r,0);l(!0),t(r)}).catch(e=>{l(!1)})},[e]),{valid:r,total:a}}function h(e){let[r,l]=(0,u.useState)(!1),[a,t]=(0,u.useState)(void 0);return(0,u.useEffect)(()=>{c.validate(e).then(e=>{l(!0),t(e)}).catch(e=>{l(!1)})},[e]),{valid:r,scores:a}}function f(e){let{scores:r,model:l}=e,{valid:t,total:s}=x(r),{scores:i}=h(r),n=i?1-l.predict(i):void 0;return n&&console.log(l.get_centered_data(i)),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(m.Ct,{className:"max-w-sm justify-center",size:"lg",children:["Total score: ",t?s:"..."]}),(0,a.jsxs)(m.Ct,{className:"max-w-sm justify-center",size:"lg",children:["Predicted risk: ",n?n.toPrecision(3):"..."]})]})}var g=l(90076);function p(){return(0,a.jsxs)("div",{role:"status",className:"w-[500px] h-[200px] animate-pulse",children:[(0,a.jsx)("div",{className:"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-32 mb-2.5"}),(0,a.jsx)("div",{className:"w-48 h-2 mb-1 bg-gray-200 rounded-full dark:bg-gray-700"}),(0,a.jsxs)("div",{className:"flex items-baseline mt-1",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-20 dark:bg-gray-700"}),(0,a.jsx)("div",{className:"w-full ms-6 bg-gray-200 rounded-t-lg h-24 dark:bg-gray-700"}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-20 ms-6 dark:bg-gray-700"}),(0,a.jsx)("div",{className:"w-full ms-6 bg-gray-200 rounded-t-lg h-24 dark:bg-gray-700"}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-18 ms-6 dark:bg-gray-700"})]})]})}let b=[{label:"Low risk",min:0,max:60,width:60},{label:"Moderate risk",min:60,max:80,width:20},{label:"High risk",min:80,max:100,width:20}];function v(e){let r=(0,u.useRef)(null),{scores:l}=e,{valid:t,total:s}=x(l);return(0,u.useEffect)(()=>{var e;let l=g.g({title:"Total score",width:500,height:150,x:{grid:!0,label:"ACE-III total score"},color:{type:"ordinal",scheme:"YlOrRd",domain:["Low risk","Moderate risk","High risk"],reverse:!0,legend:!0},marks:[g.Me({ticks:[]}),g.JA(b,{x1:"min",x2:"max",y1:0,y2:10,fill:"label",opacity:.7}),t?g.zD([{score:s}],{x:"score",stroke:"black",marker:"circle",strokeWidth:2}):null]});return null==r||null===(e=r.current)||void 0===e||e.replaceChildren(l),()=>l.remove()}),(0,a.jsx)("div",{ref:r,children:(0,a.jsx)(p,{})})}function y(e){let{label:r,name:l,...s}=e,{register:i,getFieldState:n}=(0,t.Gc)(),o=n(l),c=o.isDirty?o.invalid?"failure":"success":void 0;return(0,a.jsxs)("div",{children:[(0,a.jsx)(m.__,{htmlFor:l,children:r}),(0,a.jsx)(m.oi,{type:"number",color:c,...i(l),...s}),o.error&&(0,a.jsx)("span",{className:"text-sm text-red-400",children:o.error.message})]})}function j(e){let{form:r}=e,{handleSubmit:l}=r;return(0,a.jsxs)(m.Zb,{className:"max-w-xl",id:"score-entry",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-indigo-700",children:"Enter ACE-III scale scores"}),(0,a.jsx)(t.RV,{...r,children:(0,a.jsxs)("form",{className:"flex flex-col max-w-lg gap-4 my-2",onSubmit:l(e=>console.log(e)),children:[(0,a.jsx)(y,{label:"Attention",name:"attention"}),(0,a.jsx)(y,{label:"Memory",name:"memory"}),(0,a.jsx)(y,{label:"Fluency",name:"fluency"}),(0,a.jsx)(y,{label:"Language",name:"language"}),(0,a.jsx)(y,{label:"Visuospatial",name:"visuospatial"})]})})]})}let k=function(e){let r=0,l=[];return[...Array(100).keys()].map(()=>{l.push({start:r,end:r+.01}),r+=.01}),l}(0);function w(e){let r=(0,u.useRef)(null),{model:l}=e,{scores:t}=h(e.scores),s=t?1-l.predict(t):void 0;return(0,u.useEffect)(()=>{var e;let l=g.g({title:"Predicted risk of dementia",width:500,height:150,x:{grid:!0,label:"Risk"},color:{type:"sequential",scheme:"magma",domain:[0,1]},marks:[g.Me({ticks:[]}),g.JA(k,{x1:"start",x2:"end",y1:0,y2:10,fill:"start",opacity:.7}),s?g.zD([{score:s}],{x:"score",stroke:"black",marker:"circle",strokeWidth:2}):null]});return null==r||null===(e=r.current)||void 0===e||e.replaceChildren(l),()=>l.remove()},[s]),(0,a.jsx)("div",{ref:r,children:(0,a.jsx)(p,{})})}var _=JSON.parse('{"FO":{"intercept":-10.32498577197637,"coefs":{"attention":0.32488943647638785,"memory":0.38489972502392367,"fluency":0.6649399088480656,"language":0.8122292594499009,"visuospatial":0.27262320144200186}},"gy":[[1.1198148056383341,-0.04667157889023354,-0.029050628130672468,-0.03154225255108559,-0.1190583591997873,-0.029332239835712218],[-0.04667157889023354,0.01990916962066307,-0.0018505615413595914,-0.0003122597422042938,0.0013568544291487523,-0.004227463027503619],[-0.029050628130672468,-0.0018505615413595914,0.0051743515623118045,0.00037707762389274115,-0.0002226042259692137,-0.00009327160777052855],[-0.03154225255108559,-0.0003122597422042938,0.00037707762389274115,0.010118577556215019,-0.0008425351174451155,-0.0019587136699196254],[-0.1190583591997873,0.0013568544291487523,-0.0002226042259692137,-0.0008425351174451155,0.025285453489057252,-0.00045303533243386105],[-0.029332239835712218,-0.004227463027503619,-0.00009327160777052855,-0.0019587136699196254,-0.00045303533243386105,0.02528815793412658]],"qh":{"attention":13.74361088,"memory":16.7830033,"fluency":6.91990091,"language":20.02885408,"visuospatial":13.13685078}}'),N=l(1560),E=l(73317),R=l(41180),q=l(41940),C=l(85772),O=l(13338),A=l(26868),P=l.n(A);let S=(0,N.U)({matrixDependencies:E.Q,multiplyDependencies:R._,sqrtDependencies:q.E,transposeDependencies:C.p});class M{has_vcov(){return void 0!==this.vcov}has_means(){return void 0!==this.predictor_means}get_centered_data(e){if(!this.has_means())throw Error("You must provide predictor_means in the options to center data");return Object.fromEntries(this.predictors.map(r=>{let l=e[r]-this.predictor_means[r];return[r,l]}))}linear_prediction(e){let r=this.center_predictors?this.get_centered_data(e):e;return this.coefs.intercept+this.predictors.reduce((e,l)=>e+this.coefs.coefs[l]*r[l],0)}predict(e){return D(this.linear_prediction(e))}confidence_interval(e){var r;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95;if(!this.has_vcov())throw Error("You must provide vcov (the variance-covariance matrix) to calculate confidence intervals");let a=this.center_predictors?this.get_centered_data(e):e,t=(r=1-(1-l)/2,Math.sqrt(2)*P()(2*r-1)),s=(0,O.pIu)([1,...Object.values(a)]),i=S.multiply(S.multiply(s,this.vcov),S.transpose(s)),n=S.sqrt(i),o=this.linear_prediction(e);return[D(o-n*t),D(o+n*t)]}constructor(e,r){this.predictors=Object.keys(e.coefs),this.coefs=e,this.vcov=(null==r?void 0:r.vcov)?S.matrix(r.vcov):void 0,this.center_predictors=(null==r?void 0:r.center_predictors)||!1,this.predictor_means=(null==r?void 0:r.predictor_means)||void 0}}function D(e){return 1/(1+Math.exp(-1*e))}let I=new M(_.FO,{vcov:_.gy,predictor_means:_.qh,center_predictors:!0});function z(e){let r=(0,u.useRef)(null),{scores:l}=h(e.scores),t=d.map(e=>({scale:n[e].label,score:l?l[e]:0}));return(0,u.useEffect)(()=>{var e;let l=g.g({width:500,height:500,y:{label:"Score",domain:[0,30]},x:{domain:d.map(e=>n[e].label)},color:{type:"categorical",scheme:"Tableau10"},marks:[g.lU({label:null}),g.we(t,{y:"score",fill:"scale",x:"scale",stroke:"black"})]});return null==r||null===(e=r.current)||void 0===e||e.replaceChildren(l),()=>l.remove()},[t]),(0,a.jsx)("div",{ref:r,children:(0,a.jsx)(p,{})})}var F=JSON.parse('{"B":{"attention":17,"fluency":9,"language":24,"memory":22,"visuospatial":16}}');let T=d.map(e=>[...Array(50).keys()].map(r=>{let l=(0,O.Iyf)(40,100),a=Math.random()+l/100<1;return{scale:n[e].label,score:l,dementia:a,dementia_fill:a?"white":"black"}})).flat();function L(e){let r=(0,u.useRef)(null),{model:l}=e,{scores:t}=h(e.scores),s=t?1-l.predict(t):void 0,i=d.map(e=>({scale:n[e].label,height:100})),o=d.map(e=>{let r=F.B[e]/n[e].max*100;return{scale:n[e].label,threshold:r}}),c=d.map(e=>{let r=t?t[e]/n[e].max*100:void 0;return{scale:n[e].label,value:r}});return(0,u.useEffect)(()=>{var e;let l=g.g({width:500,height:500,y:{label:"Score (% of maximum)",domain:[0,100]},facet:{data:i,x:"scale",label:null},fx:{domain:d.map(e=>n[e].label)},color:{type:"categorical",scheme:"Tableau10"},marks:[g.Me({ticks:[],labelAnchor:"center",labelArrow:"none"}),g.we(i,{y:"height",fill:"scale",fx:"scale",opacity:.5,stroke:"black",strokeOpacity:1}),g.AK(T,g.X$("middle",{fx:"scale",y:"score",fill:"dementia_fill"})),g.rP(o,{fx:"scale",y:"threshold",stroke:"red",strokeDasharray:"3,3,3",strokeWidth:2}),t?g.rP(c,{fx:"scale",y:"value",strokeWidth:2,marker:"circle",stroke:"#5850ec"}):null]});return null==r||null===(e=r.current)||void 0===e||e.replaceChildren(l),()=>l.remove()},[s,i,c,o,t]),(0,a.jsx)("div",{ref:r,children:(0,a.jsx)(p,{})})}function J(e){return(0,a.jsxs)("div",{...e,children:[(0,a.jsx)("h2",{className:"text-indigo-600 font-bold text-lg",children:"Subdomain scores"}),(0,a.jsx)("p",{children:"This plot compares the current scores for each subdomain to those from a sample of patients with dementia and healthy controls"}),(0,a.jsx)("h3",{className:"text-lg text-indigo-800 font-bold mt-2",children:"Legend"}),(0,a.jsxs)("ul",{className:"my-1 space-y-2",children:[(0,a.jsxs)("li",{children:[(0,a.jsxs)("span",{className:"inline-flex items-center text-indigo-600 text-base p-1 border-2 me-2",children:["●",(0,a.jsx)("hr",{className:"w-4 h-1 bg-indigo-600"}),"●"]}),"Current score"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"text-red-600 font-bold p-1 border-2 me-2",children:"- - -"}),"80% of dementia patients in the sample scored at or below this level"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"text-xl text-gray-600 p-1 border-2 me-2",children:"○"})," ","Sample patient with dementia"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"text-xl text-black p-1 border-2 me-2",children:"●"})," ","Control patient (no dementia)"]})]})]})}function V(e){let{scores:r,model:l,...t}=e;return(0,a.jsx)(m.Zb,{...t,children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,a.jsx)("div",{className:"lg:basis-1/2",children:(0,a.jsx)(L,{scores:r,model:l})}),(0,a.jsx)(J,{id:"swarm-legend",className:"lg:basis-1/2 text-base max-w-prose"})]})})}let W={root:{base:"flex rounded-lg border border-gray-200 bg-white shadow-md dark:border-gray-700 dark:bg-gray-800",children:"flex h-full flex-col justify-center gap-4 p-2 md:p-6",horizontal:{off:"flex-col",on:"flex-col md:max-w-xl md:flex-row"},href:"hover:bg-gray-100 dark:hover:bg-gray-700"},img:{base:"",horizontal:{off:"rounded-t-lg",on:"h-96 w-full rounded-t-lg object-cover md:h-auto md:w-48 md:rounded-none md:rounded-l-lg"}}};function Z(){let e=(0,t.cI)({mode:"all",defaultValues:c.getDefault(),resolver:(0,s.X)(c)}),{control:r,formState:l}=e,{errors:i}=l,n=(0,t.qo)({control:r});return(0,a.jsxs)("div",{id:"ace-form",className:"flex flex-col lg:flex-row lg:flex-wrap gap-2 md:gap-4 ",children:[(0,a.jsx)(j,{form:e}),(0,a.jsxs)(m.Zb,{id:"data-display-simple",className:"flex-col max-w-xl space-y-4 min-w-96",theme:W,children:[(0,a.jsx)(f,{scores:n,model:I}),(0,a.jsx)(z,{scores:n})]}),(0,a.jsxs)(m.Zb,{id:"risk-plots",className:"flex-col max-w-xl space-y-4",children:[(0,a.jsx)(v,{scores:n}),(0,a.jsx)(w,{scores:n,model:I})]}),(0,a.jsx)(V,{id:"swarm-plots",className:"max-w-full",scores:n,model:I})]})}}},function(e){e.O(0,[431,188,156,459,949,464,215,569,274,346,744],function(){return e(e.s=80162)}),_N_E=e.O()}]);